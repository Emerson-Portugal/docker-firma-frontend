import{a as He}from"./chunk-WTW5RUH2.js";import{g as Le}from"./chunk-FPNHGTLK.js";import{e as Ae,f as Ne,h as qe,i as Je,j as $e}from"./chunk-RSM7VBVG.js";import{a as We,b as Ge}from"./chunk-Q5BYMEUU.js";import{a as ot}from"./chunk-SAF4IUW2.js";import{e as Re,g as Be,l as Ie}from"./chunk-F6ZR5WI3.js";import{b as K,c as Ee,l as ze,p as Qe,q as Ue,r as je}from"./chunk-RS23IZFS.js";import{$ as Ve,M as ae,X as Fe,Y as $,_ as De,aa as Me,ba as W,ca as ke,ha as Oe}from"./chunk-OUHVS6X7.js";import"./chunk-TBYF2LDC.js";import{a as G}from"./chunk-XLKPKAOX.js";import{D as J,i as Ce,k as be,l as N,n as Se,o as Te,p as Pe,r as xe,s as q,z}from"./chunk-ITE25VCI.js";import{$a as O,Ab as v,Bb as c,Cb as we,Db as te,Eb as g,Ga as l,Gb as f,Hb as h,Kb as _e,L as F,La as k,M as me,Ob as b,P as Z,Pb as _,Q as D,Qb as ve,Rb as x,Ta as Q,Tb as U,Ua as fe,Ub as j,V as m,Vb as H,W as u,Wb as A,X as ue,Xa as he,Xb as I,Yb as E,Za as w,ec as L,fa as ge,fc as ye,ga as ee,gc as ie,hc as oe,ib as y,ic as ne,jb as C,k as pe,mb as p,nb as s,ob as d,pb as T,tb as R,ub as B,v as ce,vb as V,vc as S,wb as P,wc as M}from"./chunk-TKL4FGBT.js";import{a as se,e as it,f as de}from"./chunk-EQDQRRRY.js";var Ke=`
    .p-dataview {
        position: relative;
        border-color: dt('dataview.border.color');
        border-width: dt('dataview.border.width');
        border-style: solid;
        border-radius: dt('dataview.border.radius');
        padding: dt('dataview.padding');
    }

    .p-dataview-header {
        background: dt('dataview.header.background');
        color: dt('dataview.header.color');
        border-color: dt('dataview.header.border.color');
        border-width: dt('dataview.header.border.width');
        border-style: solid;
        padding: dt('dataview.header.padding');
        border-radius: dt('dataview.header.border.radius');
    }

    .p-dataview-content {
        background: dt('dataview.content.background');
        border-color: dt('dataview.content.border.color');
        border-width: dt('dataview.content.border.width');
        border-style: solid;
        color: dt('dataview.content.color');
        padding: dt('dataview.content.padding');
        border-radius: dt('dataview.content.border.radius');
    }

    .p-dataview-footer {
        background: dt('dataview.footer.background');
        color: dt('dataview.footer.color');
        border-color: dt('dataview.footer.border.color');
        border-width: dt('dataview.footer.border.width');
        border-style: solid;
        padding: dt('dataview.footer.padding');
        border-radius: dt('dataview.footer.border.radius');
    }

    .p-dataview-paginator-top {
        border-width: dt('dataview.paginator.top.border.width');
        border-color: dt('dataview.paginator.top.border.color');
        border-style: solid;
    }

    .p-dataview-paginator-bottom {
        border-width: dt('dataview.paginator.bottom.border.width');
        border-color: dt('dataview.paginator.bottom.border.color');
        border-style: solid;
    }

    .p-dataview-loading-overlay {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }
`;var at=["list"],rt=["grid"],lt=["header"],st=["emptymessage"],dt=["footer"],pt=["paginatorleft"],ct=["paginatorright"],mt=["paginatordropdownitem"],ut=["loadingicon"],gt=["listicon"],ft=["gridicon"],ht=[[["p-header"]],[["p-footer"]]],wt=["p-header","p-footer"],_t=()=>({position:"top"}),Xe=t=>({$implicit:t}),vt=()=>({position:"bottom"});function yt(t,n){if(t&1&&T(0,"i"),t&2){let e=c(2);b(e.cn(e.cx("loadingIcon"),"pi-spin"+e.loadingIcon))}}function Ct(t,n){}function bt(t,n){t&1&&w(0,Ct,0,0,"ng-template")}function St(t,n){if(t&1&&(R(0),ue(),T(1,"svg",3),w(2,bt,1,0,null,4),B()),t&2){let e=c(2);l(),b(e.cx("loadingIcon")),p("spin",!0),l(),p("ngTemplateOutlet",e.loadingicon)}}function Tt(t,n){if(t&1&&(s(0,"div")(1,"div"),y(2,yt,1,2,"i",1)(3,St,3,4,"ng-container"),d()()),t&2){let e=c();b(e.cx("loading")),l(),b(e.cx("loadingOverlay")),l(),C(e.loadingIcon?2:3)}}function Pt(t,n){t&1&&V(0)}function xt(t,n){if(t&1&&(s(0,"div"),te(1),w(2,Pt,1,0,"ng-container",4),d()),t&2){let e=c();b(e.cx("header")),l(2),p("ngTemplateOutlet",e.headerTemplate)}}function Lt(t,n){if(t&1){let e=P();s(0,"p-paginator",5),v("onPageChange",function(i){m(e);let r=c();return u(r.paginate(i))}),d()}if(t&2){let e=c();p("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("appendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorleft)("templateRight",e.paginatorright)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatordropdownitem)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)("styleClass",e.cn(e.cx("pcPaginator",I(17,_t)),e.paginatorStyleClass))}}function Ft(t,n){t&1&&V(0)}function Dt(t,n){if(t&1&&(w(0,Ft,1,0,"ng-container",6),L(1,"slice")),t&2){let e=c();p("ngTemplateOutlet",e.listTemplate)("ngTemplateOutletContext",E(6,Xe,e.paginator?oe(1,2,e.filteredValue||e.value,e.lazy?0:e.first,(e.lazy?0:e.first)+e.rows):e.filteredValue||e.value))}}function Vt(t,n){t&1&&V(0)}function Mt(t,n){if(t&1&&(w(0,Vt,1,0,"ng-container",6),L(1,"slice")),t&2){let e=c();p("ngTemplateOutlet",e.gridTemplate)("ngTemplateOutletContext",E(6,Xe,e.paginator?oe(1,2,e.filteredValue||e.value,e.lazy?0:e.first,(e.lazy?0:e.first)+e.rows):e.filteredValue||e.value))}}function kt(t,n){if(t&1&&(R(0),_(1),B()),t&2){let e=c(2);l(),x(" ",e.emptyMessageLabel," ")}}function Ot(t,n){t&1&&V(0,null,0)}function Rt(t,n){if(t&1&&(s(0,"div"),w(1,kt,2,1,"ng-container",7)(2,Ot,2,0,"ng-container",4),d()),t&2){let e=c();b(e.cx("emptyMessage")),l(),p("ngIf",!e.emptymessageTemplate)("ngIfElse",e.empty),l(),p("ngTemplateOutlet",e.emptymessageTemplate)}}function Bt(t,n){if(t&1){let e=P();s(0,"p-paginator",5),v("onPageChange",function(i){m(e);let r=c();return u(r.paginate(i))}),d()}if(t&2){let e=c();p("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("appendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorleft)("templateRight",e.paginatorright)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatordropdownitem)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)("styleClass",e.cn(e.cx("pcPaginator",I(17,vt)),e.paginatorStyleClass))}}function It(t,n){t&1&&V(0)}function Et(t,n){if(t&1&&(s(0,"div"),te(1,1),w(2,It,1,0,"ng-container",4),d()),t&2){let e=c();b(e.cx("footer")),l(2),p("ngTemplateOutlet",e.footerTemplate)}}var zt={root:({instance:t})=>["p-dataview p-component",{"p-dataview-list":t.layout==="list","p-dataview-grid":t.layout==="grid"}],header:"p-dataview-header",loading:"p-dataview-loading",loadingOverlay:"p-dataview-loading-overlay p-overlay-mask",loadingIcon:"p-dataview-loading-icon",pcPaginator:({position:t})=>"p-dataview-paginator-"+t,content:"p-dataview-content",emptyMessage:"p-dataview-empty-message",footer:"p-dataview-footer"},Ye=(()=>{class t extends Oe{name="dataview";theme=Ke;classes=zt;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ee(t)))(i||t)}})();static \u0275prov=F({token:t,factory:t.\u0275fac})}return t})();var le=(()=>{class t extends Ee{paginator;rows;totalRecords;pageLinks=5;rowsPerPageOptions;paginatorPosition="bottom";paginatorStyleClass;alwaysShowPaginator=!0;paginatorDropdownAppendTo;paginatorDropdownScrollHeight="200px";currentPageReportTemplate="{currentPage} of {totalPages}";showCurrentPageReport;showJumpToPageDropdown;showFirstLastIcon=!0;showPageLinks=!0;lazy;lazyLoadOnInit=!0;emptyMessage="";styleClass;gridStyleClass="";trackBy=(e,o)=>o;filterBy;filterLocale;loading;loadingIcon;first=0;sortField;sortOrder;value;layout="list";onLazyLoad=new O;onPage=new O;onSort=new O;onChangeLayout=new O;listTemplate;gridTemplate;headerTemplate;emptymessageTemplate;footerTemplate;paginatorleft;paginatorright;paginatordropdownitem;loadingicon;listicon;gridicon;header;footer;_value;filteredValue;filterValue;initialized;_layout="list";translationSubscription;_componentStyle=D(Ye);get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(ke.EMPTY_MESSAGE)}filterService=D(Fe);ngOnInit(){super.ngOnInit(),this.lazy&&this.lazyLoadOnInit&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()}),this.initialized=!0}ngAfterViewInit(){super.ngAfterViewInit()}ngOnChanges(e){super.ngOnChanges(e),e.layout&&!e.layout.firstChange&&this.onChangeLayout.emit({layout:e.layout.currentValue}),e.value&&(this._value=e.value.currentValue,this.updateTotalRecords(),!this.lazy&&this.hasFilter()&&this.filter(this.filterValue)),(e.sortField||e.sortOrder)&&(!this.lazy||this.initialized)&&this.sort()}updateTotalRecords(){this.totalRecords=this.lazy?this.totalRecords:this._value?this._value.length:0}paginate(e){this.first=e.first,this.rows=e.rows,this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.onPage.emit({first:this.first,rows:this.rows})}sort(){this.first=0,this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.value.sort((e,o)=>{let i=ae(e,this.sortField),r=ae(o,this.sortField),a=null;return i==null&&r!=null?a=-1:i!=null&&r==null?a=1:i==null&&r==null?a=0:typeof i=="string"&&typeof r=="string"?a=i.localeCompare(r):a=i<r?-1:i>r?1:0,this.sortOrder*a}),this.hasFilter()&&this.filter(this.filterValue)),this.onSort.emit({sortField:this.sortField,sortOrder:this.sortOrder})}isEmpty(){let e=this.filteredValue||this.value;return e==null||e.length==0}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder}}getBlockableElement(){return this.el.nativeElement.children[0]}filter(e,o="contains"){if(this.filterValue=e,this.value&&this.value.length){let i=this.filterBy.split(",");this.filteredValue=this.filterService.filter(this.value,i,e,o,this.filterLocale),this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.first=0,this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0),this.cd.markForCheck()}}hasFilter(){return this.filterValue&&this.filterValue.trim().length>0}ngOnDestroy(){this.translationSubscription&&this.translationSubscription.unsubscribe(),super.ngOnDestroy()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ee(t)))(i||t)}})();static \u0275cmp=Q({type:t,selectors:[["p-dataView"],["p-dataview"],["p-data-view"]],contentQueries:function(o,i,r){if(o&1&&(g(r,at,5),g(r,rt,5),g(r,lt,5),g(r,st,5),g(r,dt,5),g(r,pt,5),g(r,ct,5),g(r,mt,5),g(r,ut,5),g(r,gt,5),g(r,ft,5),g(r,De,5),g(r,Ve,5)),o&2){let a;f(a=h())&&(i.listTemplate=a.first),f(a=h())&&(i.gridTemplate=a.first),f(a=h())&&(i.headerTemplate=a.first),f(a=h())&&(i.emptymessageTemplate=a.first),f(a=h())&&(i.footerTemplate=a.first),f(a=h())&&(i.paginatorleft=a.first),f(a=h())&&(i.paginatorright=a.first),f(a=h())&&(i.paginatordropdownitem=a.first),f(a=h())&&(i.loadingicon=a.first),f(a=h())&&(i.listicon=a.first),f(a=h())&&(i.gridicon=a.first),f(a=h())&&(i.header=a.first),f(a=h())&&(i.footer=a.first)}},hostVars:2,hostBindings:function(o,i){o&2&&b(i.cn(i.cx("root"),i.styleClass))},inputs:{paginator:[2,"paginator","paginator",S],rows:[2,"rows","rows",M],totalRecords:[2,"totalRecords","totalRecords",M],pageLinks:[2,"pageLinks","pageLinks",M],rowsPerPageOptions:"rowsPerPageOptions",paginatorPosition:"paginatorPosition",paginatorStyleClass:"paginatorStyleClass",alwaysShowPaginator:[2,"alwaysShowPaginator","alwaysShowPaginator",S],paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:[2,"showCurrentPageReport","showCurrentPageReport",S],showJumpToPageDropdown:[2,"showJumpToPageDropdown","showJumpToPageDropdown",S],showFirstLastIcon:[2,"showFirstLastIcon","showFirstLastIcon",S],showPageLinks:[2,"showPageLinks","showPageLinks",S],lazy:[2,"lazy","lazy",S],lazyLoadOnInit:[2,"lazyLoadOnInit","lazyLoadOnInit",S],emptyMessage:"emptyMessage",styleClass:"styleClass",gridStyleClass:"gridStyleClass",trackBy:"trackBy",filterBy:"filterBy",filterLocale:"filterLocale",loading:[2,"loading","loading",S],loadingIcon:"loadingIcon",first:[2,"first","first",M],sortField:"sortField",sortOrder:[2,"sortOrder","sortOrder",M],value:"value",layout:"layout"},outputs:{onLazyLoad:"onLazyLoad",onPage:"onPage",onSort:"onSort",onChangeLayout:"onChangeLayout"},features:[A([Ye]),he,ge],ngContentSelectors:wt,decls:9,vars:10,consts:[["empty",""],[3,"class"],[3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","appendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","styleClass"],["data-p-icon","spinner",3,"spin"],[4,"ngTemplateOutlet"],[3,"onPageChange","rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","appendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","styleClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"]],template:function(o,i){o&1&&(we(ht),y(0,Tt,4,5,"div",1),y(1,xt,3,3,"div",1),y(2,Lt,1,18,"p-paginator",2),s(3,"div"),y(4,Dt,2,8,"ng-container"),y(5,Mt,2,8,"ng-container"),y(6,Rt,3,5,"div",1),d(),y(7,Bt,1,18,"p-paginator",2),y(8,Et,3,3,"div",1)),o&2&&(C(i.loading?0:-1),l(),C(i.header||i.headerTemplate?1:-1),l(),C(i.paginator&&(i.paginatorPosition==="top"||i.paginatorPosition=="both")?2:-1),l(),b(i.cx("content")),l(),C(i.layout==="list"?4:-1),l(),C(i.layout==="grid"?5:-1),l(),C(i.isEmpty()&&!i.loading?6:-1),l(),C(i.paginator&&(i.paginatorPosition==="bottom"||i.paginatorPosition=="both")?7:-1),l(),C(i.footer||i.footerTemplate?8:-1))},dependencies:[q,N,Se,Je,qe,ze,W,xe],encapsulation:2,changeDetection:0})}return t})(),Ze=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=fe({type:t});static \u0275inj=me({imports:[le,W,W]})}return t})();var tt=it(ot());var Y=class t{apiUrl=`${K.BASE_URL}/empleado/mis-documentos`;http=D(J);tokenService=D(G);getAuthHeaders(){let n=this.tokenService.getToken();return new z({Authorization:`Bearer ${n}`,Accept:"application/json"})}getToken(){let n=localStorage.getItem("authToken");if(n)return n;let e=localStorage.getItem("user");if(e)try{let o=JSON.parse(e);return o?.token||o?.access_token||null}catch{return null}return null}getMyDocuments(){let n=this.getToken(),e=new z(se({accept:"application/json"},n?{Authorization:`Bearer ${n}`}:{}));return this.http.get(`${this.apiUrl}`,{headers:e}).pipe(ce(o=>(console.error("Error al obtener documentos",o),pe(()=>o))))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})};var X=class t{constructor(n,e){this.http=n;this.tokenSrv=e}apiUrl=`${K.BASE_URL}/empleado/verificar-firma`;authHeaders(){let n=new z({Accept:"application/json"}),e=this.tokenSrv.getToken();return e&&(n=n.set("Authorization",`Bearer ${e}`)),n}verificarFirma(n){return this.http.get(`${this.apiUrl}/${n}`,{headers:this.authHeaders()})}static \u0275fac=function(e){return new(e||t)(Z(J),Z(G))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})};var Ht=()=>[5,10,25,50],At=t=>({"border-t border-surface":t});function Nt(t,n){if(t&1){let e=P();R(0),s(1,"p-button",29),v("onClick",function(){m(e);let i=c().$implicit,r=c(2);return u(r.verDocumento(i))}),d(),B()}}function qt(t,n){if(t&1){let e=P();s(0,"p-button",30),v("onClick",function(){m(e);let i=c().$implicit,r=c(2);return u(r.descargar(i))}),d()}if(t&2){let e=c().$implicit,o=c(2);p("icon",o.validando[e.id]?"pi pi-spin pi-spinner":"pi pi-pencil")("label",o.validando[e.id]?"Validando...":"Firmar")("disabled",o.validando[e.id])}}function Jt(t,n){if(t&1&&(s(0,"div",21)(1,"div",22),_(2),d(),s(3,"div",23),_(4),d(),s(5,"div",24),_(6),L(7,"date"),d(),s(8,"div",24),_(9),L(10,"date"),d(),s(11,"div",25),T(12,"p-tag",26),L(13,"titlecase"),T(14,"span",27),w(15,Nt,2,0,"ng-container",28)(16,qt,1,3,"ng-template",null,1,ne),d()()),t&2){let e=n.$implicit,o=n.index,i=_e(17),r=c(2);p("ngClass",E(17,At,o!==0)),l(2),x(" ",e.nombre_archivo," "),l(2),x("Usuario: ",e.nombre_usuario),l(2),x("Subido: ",ie(7,9,e.subido_en,"medium")),l(3),x(" Firmado: ",e.firmado_en?ie(10,12,e.firmado_en,"medium"):"\u2014"," "),l(3),p("value",ye(13,15,e.estado))("severity",r.getSeverity(e.estado)),l(3),p("ngIf",e.estado==="firmado")("ngIfElse",i)}}function $t(t,n){if(t&1&&(s(0,"div",2),w(1,Jt,18,19,"div",20),d()),t&2){let e=n.$implicit,o=c();l(),p("ngForOf",e)("ngForTrackBy",o.trackDoc)}}function Wt(t,n){t&1&&(s(0,"div",31),_(1,"No hay facturas."),d())}function Gt(t,n){if(t&1&&(s(0,"div",32),_(1),d()),t&2){let e=c();l(),ve(e.error)}}var et=class t{constructor(n,e,o,i){this.listSvc=n;this.signSts=e;this.router=o;this.messageService=i}loading=!1;error=null;documentos=[];documentosFiltrados=[];validando={};estadoFiltro="all";mesFiltro=null;ordenarPor="recientes";estadoOptions=[{label:"Todos",value:"all"},{label:"Pendiente",value:"pendiente"},{label:"Firmado",value:"firmado"}];opcionesOrden=[{label:"M\xE1s recientes primero",value:"recientes"},{label:"M\xE1s antiguos primero",value:"antiguos"}];meses=[{label:"Enero",value:1},{label:"Febrero",value:2},{label:"Marzo",value:3},{label:"Abril",value:4},{label:"Mayo",value:5},{label:"Junio",value:6},{label:"Julio",value:7},{label:"Agosto",value:8},{label:"Septiembre",value:9},{label:"Octubre",value:10},{label:"Noviembre",value:11},{label:"Diciembre",value:12}];rows=10;first=0;ngOnInit(){this.cargar()}cargar(){this.loading=!0,this.error=null,this.listSvc.getMyDocuments().subscribe({next:n=>{this.documentos=n.documentos??[],this.aplicarFiltros(),this.loading=!1},error:n=>{this.error=n?.error?.detail||"No se pudieron cargar los documentos.",this.documentos=[],this.documentosFiltrados=[],this.loading=!1}})}limpiarFiltros(){this.estadoFiltro="all",this.mesFiltro=null,this.ordenarPor="recientes",this.first=0,this.aplicarFiltros()}aplicarFiltros(){let n=this.documentos.filter(e=>{let o=this.estadoFiltro==="all"||(e.estado||"").toLowerCase()===this.estadoFiltro,i=!0;return this.mesFiltro&&(i=new Date(e.subido_en).getMonth()+1===this.mesFiltro),o&&i});n.sort((e,o)=>{let i=new Date(e.subido_en).getTime(),r=new Date(o.subido_en).getTime();return this.ordenarPor==="recientes"?r-i:i-r}),this.documentosFiltrados=n}getSeverity(n){let e=(n||"").toLowerCase();return e==="firmado"?"success":e==="pendiente"?"danger":"info"}trackDoc=(n,e)=>e.id;descargar(n){return de(this,null,function*(){this.validando[n.id]=!0;try{let e=yield this.signSts.verificarFirma(n.id).toPromise();if(e?.puede_firmar)this.router.navigate(["/signature/sign-ballots",n.id],{state:{doc:n}});else{let o=e?.documento_pendiente,i=o?`Tienes el documento "${o.nombre}" (${o.fecha}) pendiente de firmar.`:"Tienes documentos pendientes de firmar.";yield tt.default.fire({title:"Documentos pendientes",html:`${i}<br>Por favor, f\xEDrmalos en orden cronol\xF3gico.`,icon:"warning",confirmButtonText:"Entendido",confirmButtonColor:"#3085d6",showCloseButton:!0})}}catch(e){console.error("Error al verificar documentos:",e),this.messageService.add({severity:"error",summary:"Error",detail:"Ocurri\xF3 un error al verificar el estado del documento",life:5e3})}finally{this.validando[n.id]=!1}})}verDocumento(n){this.router.navigate(["/signature/sign-ballots",n.id],{state:{doc:n}})}home(){window.location.href="/signature/home"}static \u0275fac=function(e){return new(e||t)(k(Y),k(X),k(Le),k($))};static \u0275cmp=Q({type:t,selectors:[["app-list-ballots-user"]],features:[A([$])],decls:28,vars:17,consts:[["list",""],["firmarButton",""],[1,"flex","flex-col"],["message","Cargando documentos...",3,"isLoading"],[1,"card","relative"],[1,"flex","items-center","mb-3"],["icon","pi pi-arrow-left","styleClass","p-button-danger p-button-rounded p-button-text mr-2",3,"click"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"block","text-600","text-sm","font-medium","mb-2"],["optionLabel","label","optionValue","value","placeholder","Filtrar por estado","styleClass","w-full",3,"ngModelChange","onChange","options","ngModel","showClear"],["optionLabel","label","optionValue","value","placeholder","Filtrar por mes","styleClass","w-full",3,"ngModelChange","onChange","options","ngModel","showClear"],[1,"flex","items-end","gap-2"],[1,"flex-1","flex","flex-col"],["optionLabel","label","optionValue","value","styleClass","w-full",3,"ngModelChange","onChange","options","ngModel"],[1,"flex","items-end"],["pButton","","type","button","icon","pi pi-filter-slash","label","Limpiar",1,"p-button-text","p-button-sm",2,"height","36px","margin-bottom","2px",3,"click"],["layout","list","paginatorPosition","both",3,"value","paginator","rows","rowsPerPageOptions","first","alwaysShowPaginator"],["pTemplate","empty"],["class","mt-3 text-red-600",4,"ngIf"],["class","flex flex-col p-6 gap-3",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-col","p-6","gap-3",3,"ngClass"],[1,"text-lg","font-medium","break-all","text-blue-600"],[1,"mt-1","text-surface-500","text-sm"],[1,"text-surface-500","text-sm"],[1,"mt-2","flex","items-center","gap-3","flex-nowrap"],[1,"shrink-0",3,"value","severity"],[1,"grow"],[4,"ngIf","ngIfElse"],["icon","pi pi-eye","label","Ver","severity","info","raised","","size","small",1,"shrink-0","whitespace-nowrap","px-5","h-9","rounded-md",3,"onClick"],["severity","success","raised","","size","small",1,"shrink-0","whitespace-nowrap","px-5","h-9","rounded-md",3,"onClick","icon","label","disabled"],[1,"p-6","text-center","text-surface-500"],[1,"mt-3","text-red-600"]],template:function(e,o){if(e&1){let i=P();s(0,"div",2),T(1,"app-loading",3),s(2,"div",4)(3,"div",5)(4,"p-button",6),v("click",function(){return m(i),u(o.home())}),d(),s(5,"div",7),_(6,"Mis Documentos"),d()(),s(7,"div",8)(8,"div",2)(9,"label",9),_(10,"Estado"),d(),s(11,"p-select",10),H("ngModelChange",function(a){return m(i),j(o.estadoFiltro,a)||(o.estadoFiltro=a),u(a)}),v("onChange",function(){return m(i),u(o.aplicarFiltros())}),d()(),s(12,"div",2)(13,"label",9),_(14,"Mes"),d(),s(15,"p-select",11),H("ngModelChange",function(a){return m(i),j(o.mesFiltro,a)||(o.mesFiltro=a),u(a)}),v("onChange",function(){return m(i),u(o.aplicarFiltros())}),d()(),s(16,"div",12)(17,"div",13)(18,"label",9),_(19,"Ordenar por"),d(),s(20,"p-select",14),H("ngModelChange",function(a){return m(i),j(o.ordenarPor,a)||(o.ordenarPor=a),u(a)}),v("onChange",function(){return m(i),u(o.aplicarFiltros())}),d()(),s(21,"div",15)(22,"button",16),v("click",function(){return m(i),u(o.limpiarFiltros())}),d()()()(),s(23,"p-dataview",17),w(24,$t,2,2,"ng-template",null,0,ne)(26,Wt,2,0,"ng-template",18),d(),w(27,Gt,2,1,"div",19),d()()}e&2&&(l(),p("isLoading",o.loading),l(10),p("options",o.estadoOptions),U("ngModel",o.estadoFiltro),p("showClear",!0),l(4),p("options",o.meses),U("ngModel",o.mesFiltro),p("showClear",!0),l(5),p("options",o.opcionesOrden),U("ngModel",o.ordenarPor),l(3),p("value",o.documentosFiltrados)("paginator",!0)("rows",o.rows)("rowsPerPageOptions",I(16,Ht))("first",o.first)("alwaysShowPaginator",!1),l(4),p("ngIf",o.error))},dependencies:[q,Ce,be,N,Ie,Re,Be,Ze,le,Me,$e,Ge,We,je,Qe,Ue,He,Ne,Ae,Te,Pe],encapsulation:2})};export{et as ListBallotsUserComponent};
