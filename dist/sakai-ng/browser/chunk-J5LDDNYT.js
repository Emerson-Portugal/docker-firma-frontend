import{b as M}from"./chunk-K7BOYT7K.js";import{g as ne,h as ie,n as ae}from"./chunk-FPNHGTLK.js";import{b as Se,c as Fe,d as Ee,e as we,f as Ie,g as Te}from"./chunk-IKIVL5BN.js";import{e as Ce,f as _e}from"./chunk-45OTRKZG.js";import{a as N,b as B}from"./chunk-2GZEO4PA.js";import{a as ke,b as Ue}from"./chunk-XLYG6UBL.js";import{a as ze}from"./chunk-SAF4IUW2.js";import{b as me,c as u,e as pe,f as de,h as ue,i as ce,j as fe,k as ge,m as ve,n as he,o as R}from"./chunk-PXHTZTO3.js";import{c as be,n as ye,o as xe,p as L,r as D}from"./chunk-77BGPX7E.js";import{Y as A,aa as le,ba as T,ha as se}from"./chunk-OUHVS6X7.js";import"./chunk-TBYF2LDC.js";import"./chunk-XLKPKAOX.js";import{i as ee,k as te,l as re,p as oe,s as h}from"./chunk-ITE25VCI.js";import{Ab as y,Bb as v,Ga as a,L as V,La as X,M as H,Nb as Q,Ob as W,Pb as s,Q as f,Qb as k,Rb as b,Ta as g,Ua as $,Wb as U,Xa as J,Xb as I,Yb as x,Za as d,ec as Y,ga as q,gc as Z,hb as K,mb as m,nb as i,ob as o,pb as p}from"./chunk-TKL4FGBT.js";import{a as z,b as j,e as Pe}from"./chunk-EQDQRRRY.js";var O=Pe(ze());var P=t=>({"p-invalid":t});function Ge(t,n){if(t&1&&(i(0,"small",21),s(1),o()),t&2){let r,e=v();a(),b(" ",!((r=e.userForm.get("dni"))==null||r.errors==null)&&r.errors.required?"El DNI es requerido":"Formato de DNI inv\xE1lido (8-12 d\xEDgitos)"," ")}}function Ve(t,n){t&1&&(i(0,"small",21),s(1," El nombre es requerido "),o())}function He(t,n){if(t&1&&(i(0,"small",21),s(1),o()),t&2){let r,e=v();a(),b(" ",!((r=e.userForm.get("email"))==null||r.errors==null)&&r.errors.required?"El correo es requerido":"Formato de correo inv\xE1lido"," ")}}function Xe(t,n){if(t&1&&(i(0,"small",21),s(1),o()),t&2){let r,e=v();a(),b(" ",!((r=e.userForm.get("password"))==null||r.errors==null)&&r.errors.required?"La contrase\xF1a es requerida":"Debe tener al menos 6 caracteres"," ")}}var Me=class t{fb=f(ge);userService=f(M);messageService=f(A);router=f(ne);roles=[{label:"Empleado",value:"empleado"},{label:"RRHH",value:"rrhh"},{label:"Soporte",value:"soporte"}];userForm=this.fb.group({dni:["",[u.required,u.pattern("^[0-9]{8,12}$")]],nombre:["",[u.required]],email:["",[u.required,u.email]],rol:["empleado",[u.required]],activo:[!0],password:["",[u.required,u.minLength(8)]]});loading=!1;showErrorAlert(n,r){O.default.fire({title:n,text:r,icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#3B82F6"})}showSuccessAlert(n){O.default.fire({title:"\xA1\xC9xito!",text:n,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#10B981"})}onSubmit(){if(this.userForm.invalid){this.userForm.markAllAsTouched();return}this.loading=!0;let n=this.userForm.value;this.userService.createUser(n).subscribe({next:e=>{this.showSuccessAlert("Usuario creado correctamente"),this.userForm.reset({rol:"empleado",activo:!0})},error:e=>{console.error("Error al crear usuario:",e);let l="Ha ocurrido un error inesperado";if(e.status===0?l="No se pudo conectar con el servidor. Verifica tu conexi\xF3n a internet.":e.status===400?l=e.error?.message||"Datos inv\xE1lidos. Por favor, verifica la informaci\xF3n ingresada.":e.status===401||e.status===403?l="No tienes permisos para realizar esta acci\xF3n":e.status===404?l="Recurso no encontrado":e.status>=500&&(l="Error en el servidor. Por favor, int\xE9ntalo m\xE1s tarde."),e.error?.errors){let c=Object.values(e.error.errors).flat().join(`
`);this.showErrorAlert("Error de validaci\xF3n",c)}else this.showErrorAlert("Error",l)}}).add(()=>{this.loading=!1})}onCancel(){this.router.navigate(["/signature"])}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=g({type:t,selectors:[["app-create-user"]],features:[U([A])],decls:35,vars:22,consts:[[1,"p-4"],["header","Crear Nuevo Usuario",1,"max-w-3xl","mx-auto","shadow-lg","rounded-2xl"],[1,"grid","gap-6",3,"ngSubmit","formGroup"],[1,"flex","flex-col"],["for","dni",1,"mb-2","font-semibold","text-gray-700"],["id","dni","type","text","pInputText","","formControlName","dni","placeholder","Ingrese el DNI",1,"w-full",3,"ngClass"],["class","p-error mt-1",4,"ngIf"],["for","nombre",1,"mb-2","font-semibold","text-gray-700"],["id","nombre","type","text","pInputText","","formControlName","nombre","placeholder","Ingrese el nombre completo",1,"w-full",3,"ngClass"],["for","email",1,"mb-2","font-semibold","text-gray-700"],["id","email","type","email","pInputText","","formControlName","email","placeholder","ejemplo@dominio.com",1,"w-full",3,"ngClass"],["for","rol",1,"mb-2","font-semibold","text-gray-700"],["id","rol","formControlName","rol","optionLabel","label","optionValue","value","placeholder","Seleccione un rol",1,"w-full",3,"options"],["for","password",1,"mb-2","font-semibold","text-gray-700"],["id","password","type","password","pInputText","","formControlName","password","placeholder","M\xEDnimo 6 caracteres",1,"w-full",3,"ngClass"],[1,"flex","items-center","space-x-2"],["id","activo","formControlName","activo","inputId","activo",3,"binary"],["for","activo",1,"text-gray-700"],[1,"flex","flex-wrap","justify-end","gap-3","mt-6"],["pButton","","type","button","label","Cancelar",1,"p-button-secondary",3,"click","disabled"],["pButton","","type","submit","label","Crear",1,"p-button-primary",3,"disabled","loading"],[1,"p-error","mt-1"]],template:function(r,e){if(r&1&&(i(0,"div",0),p(1,"p-toast"),i(2,"p-card",1)(3,"form",2),y("ngSubmit",function(){return e.onSubmit()}),i(4,"div",3)(5,"label",4),s(6,"DNI"),o(),p(7,"input",5),d(8,Ge,2,1,"small",6),o(),i(9,"div",3)(10,"label",7),s(11,"Nombre Completo"),o(),p(12,"input",8),d(13,Ve,2,0,"small",6),o(),i(14,"div",3)(15,"label",9),s(16,"Correo Electr\xF3nico"),o(),p(17,"input",10),d(18,He,2,1,"small",6),o(),i(19,"div",3)(20,"label",11),s(21,"Rol"),o(),p(22,"p-select",12),o(),i(23,"div",3)(24,"label",13),s(25,"Contrase\xF1a"),o(),p(26,"input",14),d(27,Xe,2,1,"small",6),o(),i(28,"div",15),p(29,"p-checkbox",16),i(30,"label",17),s(31,"Usuario Activo"),o()(),i(32,"div",18)(33,"button",19),y("click",function(){return e.onCancel()}),o(),p(34,"button",20),o()()()()),r&2){let l,c,C,_,S,F,E,w;a(3),m("formGroup",e.userForm),a(4),m("ngClass",x(14,P,((l=e.userForm.get("dni"))==null?null:l.invalid)&&((l=e.userForm.get("dni"))==null?null:l.touched))),a(),m("ngIf",((c=e.userForm.get("dni"))==null?null:c.invalid)&&((c=e.userForm.get("dni"))==null?null:c.touched)),a(4),m("ngClass",x(16,P,((C=e.userForm.get("nombre"))==null?null:C.invalid)&&((C=e.userForm.get("nombre"))==null?null:C.touched))),a(),m("ngIf",((_=e.userForm.get("nombre"))==null?null:_.invalid)&&((_=e.userForm.get("nombre"))==null?null:_.touched)),a(4),m("ngClass",x(18,P,((S=e.userForm.get("email"))==null?null:S.invalid)&&((S=e.userForm.get("email"))==null?null:S.touched))),a(),m("ngIf",((F=e.userForm.get("email"))==null?null:F.invalid)&&((F=e.userForm.get("email"))==null?null:F.touched)),a(4),m("options",e.roles),a(4),m("ngClass",x(20,P,((E=e.userForm.get("password"))==null?null:E.invalid)&&((E=e.userForm.get("password"))==null?null:E.touched))),a(),m("ngIf",((w=e.userForm.get("password"))==null?null:w.invalid)&&((w=e.userForm.get("password"))==null?null:w.touched)),a(2),m("binary",!0),a(4),m("disabled",e.loading),a(),m("disabled",e.userForm.invalid||e.loading)("loading",e.loading)}},dependencies:[h,ee,re,ve,ue,me,pe,de,ce,fe,B,N,D,L,R,he,_e,Ce,Fe,Se,Te,Ie],encapsulation:2})};var Le=`
    .p-skeleton {
        display: block;
        overflow: hidden;
        background: dt('skeleton.background');
        border-radius: dt('skeleton.border.radius');
    }

    .p-skeleton::after {
        content: '';
        animation: p-skeleton-animation 1.2s infinite;
        height: 100%;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
        transform: translateX(-100%);
        z-index: 1;
        background: linear-gradient(90deg, rgba(255, 255, 255, 0), dt('skeleton.animation.background'), rgba(255, 255, 255, 0));
    }

    [dir='rtl'] .p-skeleton::after {
        animation-name: p-skeleton-animation-rtl;
    }

    .p-skeleton-circle {
        border-radius: 50%;
    }

    .p-skeleton-animation-none::after {
        animation: none;
    }

    @keyframes p-skeleton-animation {
        from {
            transform: translateX(-100%);
        }
        to {
            transform: translateX(100%);
        }
    }

    @keyframes p-skeleton-animation-rtl {
        from {
            transform: translateX(100%);
        }
        to {
            transform: translateX(-100%);
        }
    }
`;var $e={root:{position:"relative"}},Je={root:({instance:t})=>["p-skeleton p-component",{"p-skeleton-circle":t.shape==="circle","p-skeleton-animation-none":t.animation==="none"}]},De=(()=>{class t extends se{name="skeleton";theme=Le;classes=Je;inlineStyles=$e;static \u0275fac=(()=>{let r;return function(l){return(r||(r=q(t)))(l||t)}})();static \u0275prov=V({token:t,factory:t.\u0275fac})}return t})();var G=(()=>{class t extends be{styleClass;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";_componentStyle=f(De);get containerStyle(){let r=this._componentStyle?.inlineStyles.root,e;return this.size?e=j(z({},r),{width:this.size,height:this.size,borderRadius:this.borderRadius}):e=j(z({},r),{width:this.width,height:this.height,borderRadius:this.borderRadius}),e}static \u0275fac=(()=>{let r;return function(l){return(r||(r=q(t)))(l||t)}})();static \u0275cmp=g({type:t,selectors:[["p-skeleton"]],hostVars:7,hostBindings:function(e,l){e&2&&(K("aria-hidden",!0)("data-pc-name","skeleton")("data-pc-section","root"),Q(l.containerStyle),W(l.cn(l.cx("root"),l.styleClass)))},inputs:{styleClass:"styleClass",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},features:[U([De]),J],decls:0,vars:0,template:function(e,l){},dependencies:[h,T],encapsulation:2,changeDetection:0})}return t})(),Ne=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=$({type:t});static \u0275inj=H({imports:[G,T,T]})}return t})();var Qe=()=>[5,10,25,50],We=()=>[0,1,2,3,4],Ye=()=>["dni","nombre","email","rol","estado","fecha"];function Ze(t,n){t&1&&(i(0,"tr",12)(1,"th",13),s(2,"DNI"),o(),i(3,"th",13),s(4,"Nombre"),o(),i(5,"th",13),s(6,"Email"),o(),i(7,"th",13),s(8,"Rol"),o(),i(9,"th",13),s(10,"Estado"),o(),i(11,"th",13),s(12,"Creado"),o()())}function et(t,n){if(t&1&&(i(0,"tr",14)(1,"td",15),s(2),o(),i(3,"td",16),s(4),o(),i(5,"td",17),s(6),o(),i(7,"td",15),p(8,"p-tag",18),o(),i(9,"td",15),p(10,"p-tag",18),o(),i(11,"td",19),s(12),Y(13,"date"),o()()),t&2){let r=n.$implicit,e=v();a(2),k(r.dni),a(2),k(r.nombre),a(2),k(r.email),a(2),m("value",e.getRoleLabel(r.rol))("severity",r.rol==="soporte"?"info":"primary"),a(2),m("value",e.getStatusLabel(r.activo))("severity",e.getSeverity(r.activo)),a(2),b(" ",Z(13,8,r.creado_en,"dd/MM/yyyy")," ")}}function tt(t,n){t&1&&(i(0,"tr")(1,"td",20)(2,"div",21),p(3,"i",22),i(4,"p",23),s(5,"No se encontraron usuarios"),o()()()())}function rt(t,n){t&1&&(i(0,"td",15),p(1,"p-skeleton"),o())}function ot(t,n){t&1&&(i(0,"tr"),d(1,rt,2,0,"td",25),o()),t&2&&(a(),m("ngForOf",I(1,Ye)))}function nt(t,n){t&1&&d(0,ot,2,2,"tr",24),t&2&&m("ngForOf",I(1,We))}var Be=class t{constructor(n){this.userService=n}users=[];loading=!0;totalRecords=0;rows=10;first=0;searchTerm="";ngOnInit(){this.loadUsers()}loadUsers(){this.loading=!0;let n=this.first,r=this.rows;console.log("Loading users with skip:",n,"limit:",r),this.userService.listUsers(n,r).subscribe({next:e=>{console.log("Users loaded:",e),this.users=e.data,this.totalRecords=e.total,this.loading=!1},error:e=>{console.error("Error loading users:",e),this.loading=!1}})}onPageChange(n){this.first=n.first||0,this.rows=n.rows||10,this.loadUsers()}getSeverity(n){return n?"success":"danger"}getStatusLabel(n){return n?"Activo":"Inactivo"}getRoleLabel(n){switch(n){case"empleado":return"Empleado";case"rrhh":return"RRHH";case"soporte":return"Soporte";default:return n}}static \u0275fac=function(r){return new(r||t)(X(M))};static \u0275cmp=g({type:t,selectors:[["app-list-users"]],decls:13,vars:10,consts:[[1,"p-4"],["header","Lista de Usuarios",1,"shadow-lg","rounded-xl"],[1,"flex","flex-col","space-y-4"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-2xl","font-bold","text-gray-800"],["pButton","","pRipple","","type","button","icon","pi pi-plus","label","Nuevo Usuario","routerLink","/users/create",1,"p-button-primary"],[1,"overflow-x-auto"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} usuarios","responsiveLayout","scroll","styleClass","p-datatable-striped p-datatable-sm",3,"onLazyLoad","value","lazy","paginator","rows","totalRecords","loading","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"bg-gray-50"],[1,"text-left","p-3","text-xs","font-semibold","text-gray-600","uppercase"],[1,"hover:bg-gray-50","transition-colors"],[1,"p-3","border-b","border-gray-100"],[1,"p-3","border-b","border-gray-100","font-medium"],[1,"p-3","border-b","border-gray-100","text-gray-600"],["styleClass","text-xs",3,"value","severity"],[1,"p-3","border-b","border-gray-100","text-sm","text-gray-600"],["colspan","6",1,"p-6","text-center"],[1,"flex","flex-col","items-center","justify-center","py-8","text-gray-500"],[1,"pi","pi-users","text-4xl","mb-2","text-gray-300"],[1,"text-gray-500"],[4,"ngFor","ngForOf"],["class","p-3 border-b border-gray-100",4,"ngFor","ngForOf"]],template:function(r,e){r&1&&(i(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"h2",4),s(5,"Gesti\xF3n de Usuarios"),o(),p(6,"button",5),o(),i(7,"div",6)(8,"p-table",7),y("onLazyLoad",function(c){return e.onPageChange(c)}),d(9,Ze,13,0,"ng-template",8)(10,et,14,11,"ng-template",9)(11,tt,6,0,"ng-template",10)(12,nt,1,2,"ng-template",11),o()()()()()),r&2&&(a(8),m("value",e.users)("lazy",!0)("paginator",!0)("rows",e.rows)("totalRecords",e.totalRecords)("loading",e.loading)("rowsPerPageOptions",I(9,Qe))("showCurrentPageReport",!0)("paginator",!0))},dependencies:[h,te,ae,ie,D,L,le,we,Ee,B,N,R,xe,ye,Ue,ke,Ne,G,oe],encapsulation:2})};export{Me as CreateUserComponent,Be as ListUsersComponent};
