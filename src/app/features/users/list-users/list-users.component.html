<div class="p-4">
    <p-card header="Lista de Usuarios" class="shadow-lg rounded-xl">
        <div class="flex flex-col space-y-4">
            <!-- Header with title and create button -->
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <h2 class="text-2xl font-bold text-gray-800">Gesti√≥n de Usuarios</h2>
                <button pButton pRipple type="button" icon="pi pi-plus" label="Nuevo Usuario" class="p-button-primary" routerLink="/users/create"></button>
            </div>

            <!-- Users Table -->
            <div class="overflow-x-auto">
                <p-table
                    [value]="users"
                    [lazy]="true"
                    [paginator]="true"
                    [rows]="rows"
                    [totalRecords]="totalRecords"
                    [loading]="loading"
                    (onLazyLoad)="onPageChange($event)"
                    [rowsPerPageOptions]="[5, 10, 25, 50]"
                    [showCurrentPageReport]="true"
                    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} usuarios"
                    responsiveLayout="scroll"
                    styleClass="p-datatable-striped p-datatable-sm"
                    [paginator]="true"
                >
                    <ng-template pTemplate="header">
                        <tr class="bg-gray-50">
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">DNI</th>
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">Nombre</th>
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">Email</th>
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">Rol</th>
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">Estado</th>
                            <th class="text-left p-3 text-xs font-semibold text-gray-600 uppercase">Creado</th>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="body" let-user>
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="p-3 border-b border-gray-100">{{ user.dni }}</td>
                            <td class="p-3 border-b border-gray-100 font-medium">{{ user.nombre }}</td>
                            <td class="p-3 border-b border-gray-100 text-gray-600">{{ user.email }}</td>
                            <td class="p-3 border-b border-gray-100">
                                <p-tag [value]="getRoleLabel(user.rol)" [severity]="user.rol === 'soporte' ? 'info' : 'primary'" styleClass="text-xs"> </p-tag>
                            </td>
                            <td class="p-3 border-b border-gray-100">
                                <p-tag [value]="getStatusLabel(user.activo)" [severity]="getSeverity(user.activo)" styleClass="text-xs"> </p-tag>
                            </td>
                            <td class="p-3 border-b border-gray-100 text-sm text-gray-600">
                                {{ user.creado_en | date: 'dd/MM/yyyy' }}
                            </td>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="6" class="p-6 text-center">
                                <div class="flex flex-col items-center justify-center py-8 text-gray-500">
                                    <i class="pi pi-users text-4xl mb-2 text-gray-300"></i>
                                    <p class="text-gray-500">No se encontraron usuarios</p>
                                </div>
                            </td>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="loadingbody" let-columns="columns">
                        <tr *ngFor="let i of [0, 1, 2, 3, 4]">
                            <td *ngFor="let col of ['dni', 'nombre', 'email', 'rol', 'estado', 'fecha']" class="p-3 border-b border-gray-100">
                                <p-skeleton></p-skeleton>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </p-card>
</div>
